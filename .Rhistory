res10000_9000= NLSS(data=FC_data_new,q=7,total_iter = 10000, burn_in = 9000, show_step=10)
saveRDS(res10000_9000, file = "/Users/ben/Desktop/work2/Rpackagetest/nlss/S/res10000_9000_q7_fmri504.rds")
A_PNC = data.frame(sx = sx, A = res7$A[,8])
p = ggplot(A_PNC, aes(x=sx, y=A ) ) +
geom_boxplot() + labs(x=NULL, y = NULL)+ ylim(0,0.6)
p
age==F
age=="F"
age
sx ==F
sx =="F"
tex = t.test(res7$A[sx=="F",8], res7$A[sx=="M",8])
tex
tsx = t.test(res7$A[sx=="F",8], res7$A[sx=="M",8])
summary(tsx)
tsx
slot(tsx)
t.test
?t.test
tsx$p.value
for(i in 1:8){
tsx = t.test(res7$A[sx=="F",i], res7$A[sx=="M",i])
print(paste0(i," ",tsx$p.value) )
}
A_PNC = data.frame(sx = sx, A = res7$A[,4])
p = ggplot(A_PNC, aes(x=sx, y=A ) ) +
geom_boxplot() + labs(x=NULL, y = NULL)+ ylim(0,0.6)
p
A_PNC = data.frame(sx = sx, A = res7$A[,6])
p = ggplot(A_PNC, aes(x=sx, y=A ) ) +
geom_boxplot() + labs(x=NULL, y = NULL)+ ylim(0,0.6)
p
A_PNC = data.frame(sx = sx, A = res7$A[,7])
p = ggplot(A_PNC, aes(x=sx, y=A ) ) +
geom_boxplot() + labs(x=NULL, y = NULL)+ ylim(0,0.6)
p
A_PNC = data.frame(sx = sx, A = res7$A[,8])
p = ggplot(A_PNC, aes(x=sx, y=A ) ) +
geom_boxplot() + labs(x=NULL, y = NULL)+ ylim(0,0.6)
p
plot(res7$A[,5]~age)
lmage = lm(res7$A[,5]~age)
summary(lmage)
?lm
lmage$coefficients
lmage = lm(res7$A[,1]~age)
summary(lmage)
plot(res7$A[,2]~age)
lmage = lm(res7$A[,2]~age)
summary(lmage)
plot(res7$A[,3]~age)
lmage = lm(res7$A[,3]~age)
summary(lmage)
lmage = lm(age~res7$A[,])
summary(lmage)
lmage = lm(age~res7$A[,1:8])
summary(lmage)
plot(age~res7$A[,8])
plot(res7$A[,8]~age)
plot(res7$A[,5]~age)
lmage = lm(age~res7$A[,c(5,8)])
summary(lmage)
sx0 = tmp1$Sex
sx = sx0[match(sbj_ID,sbj_ID_cova)]
age0 = tmp1$Age
age = age0[match(sbj_ID,sbj_ID_cova)]
A_PNC = data.frame(sx = sx, A = res7$A[,8])
p = ggplot(A_PNC, aes(x=sx, y=A ) ) +
geom_boxplot() + labs(x=NULL, y = NULL)+ ylim(0,0.6)
p
for(i in 1:8){
tsx = t.test(res7$A[sx=="F",i], res7$A[sx=="M",i])
print(paste0(i," ",tsx$p.value) )
}
A_PNC = data.frame(sx = sx, A = res7$A[,8])
p = ggplot(A_PNC, aes(x=sx, y=A ) ) +
geom_boxplot() + labs(x=NULL, y = NULL)+ ylim(0,0.6)
p
A_PNC = data.frame(sx = sx, A = res7$A[,4])
p = ggplot(A_PNC, aes(x=sx, y=A ) ) +
geom_boxplot() + labs(x=NULL, y = NULL)+ ylim(0,0.6)
p
p = ggplot(A_PNC, aes(x=sx, y=A ) ) +
geom_boxplot() + labs(x=NULL, y = NULL)+ ylim(0,0.2)
p
lmage = lm(age~res7$A[,1:8])
summary(lmage)
lm(res7$A[,8]~age)
summary(lmage)
lmage = lm(res7$A[,8]~age)
summary(lmage)
lmage = lm(res7$A[,8]~age + sx)
summary(lmage)
plot(res7$A[,5]~age)
plot(res7$A[,8]~age)
dim(FC_data)
FC_data_new
dim(FC_data_new)
sample(nrow(FC_data_new),350,replace = FALSE)
set.seed(233)
for(i in 1:10){
ind0 = sample(nrow(FC_data_new),350,replace = FALSE)
res10000_9000= NLSS(data=FC_data_new[ind0,],q=8,total_iter = 10000, burn_in = 9000, show_step=1000)
saveRDS(res10000_9000, file = paste0("/Users/ben/Desktop/work2/Rpackagetest/nlss/S/res10000_9000_q8_fmri504_r",i,".rds") )
}
set.seed(233)
for(i in 1:10){
print(i)
ind0 = sample(nrow(FC_data_new),350,replace = FALSE)
res10000_9000 = NLSS(data=FC_data_new[ind0,],q=8,total_iter = 10000, burn_in = 9000, show_step=1000)
saveRDS(res10000_9000, file = paste0("/Users/ben/Desktop/work2/Rpackagetest/nlss/S/res10000_9000_q8_fmri504_r",i,".rds") )
rm(res10000_9000)
gc()
}
(1564.70+29.99+42.93)/2
sapply_pb <- function(X, FUN, ...)
{
env <- environment()
pb_Total <- length(X)
counter <- 0
pb <- txtProgressBar(min = 0, max = pb_Total, style = 3)
wrapper <- function(...){
curVal <- get("counter", envir = env)
assign("counter", curVal +1 ,envir=env)
setTxtProgressBar(get("pb", envir=env), curVal +1)
FUN(...)
}
res <- sapply(X, wrapper, ...)
close(pb)
res
}
compute.comp.match.mat = function(S_true,S_est){
idx = expand.grid(1:nrow(S_true),1:nrow(S_est))
return(matrix(sapply_pb(1:nrow(idx),
function(i) max(mean(S_true[idx[i,1],]==S_est[idx[i,2],]), mean(S_true[idx[i,1],]==(max(S_true)+1-S_est[idx[i,2],])))),
nrow=nrow(S_true),ncol=nrow(S_est)))
}
compute.match.idx.s.tra = function(S_est,S_true){
dist_mat = compute.comp.match.mat(S_true,S_est)
per = permutations(ncol(dist_mat),nrow(dist_mat))
sum.match = function(x){
out = 0
for(i in 1:length(x)){
out = out + dist_mat[i,x[i]]
}
return(out)
}
return( per[which.max(apply(per,1,sum.match)),] )
}
f1 = function(S0,S){
F1 = 0
for(i in 1:nrow(S0)){
TP = sum( (S0[i,]==1)*(S[i,]==1) )
F1 = F1 + 2*TP/( sum(S0[i,]==1) + sum(S[i,]==1))
}
F2 = 0
for(i in 1:nrow(S0)){
TP = sum( (S0[i,]==1)*(S[i,]==0) )
F1 = F1 + 2*TP/( sum(S0[i,]==1) + sum(S[i,]==0))
}
return( max(F1/nrow(S0),F2/nrow(S0)) )
}
FMRI_path = "/Users/ben/Desktop/work2/data/PNC data/FMRI data/"
cova_path = "/Users/ben/Desktop/work2/data/PNC data/Demographic data/"
tmp1 = read.csv(paste0(cova_path,"PNC_Gender_Age.csv"))
tmp = read.csv(paste0(cova_path,"PNC_Phenotypes_imaging_subset1.csv"))
tmp = read.table(paste0(FMRI_path,"filtered.list.displac.25_2_.txt"))
sbj_ID_cova = tmp1$SUBJID
sbj_ID_fmri = tmp$V1
sbj_ID = intersect(sbj_ID,sbj_ID_cova)
dim(sbj_ID_cova)
length(sbj_ID_cova)
length(sbj_ID_fmri)
sbj_ID = intersect(sbj_ID_fmri,sbj_ID_cova)
length(sbj_ID)
match(sbj_ID,sbj_ID_fmri)
load(paste0(FMRI_path,"Pearson264.RData"))
group = read.table("/Users/ben/Desktop/work2/data/PNC/roi_id.txt")
group_1 = group$V1
group_2 = group_1[order(group_1)][-c(1:32)]
lengthlist = length(pearsonCorr.matrix)
C_list = list()
FC_list = list()
for(i in 1:lengthlist){
print(i)
tmp = pearsonCorr.matrix[[i]][order(group_1),order(group_1)]
FC_list[[i]] = tmp[-c(1:32),-c(1:32)]
}
FC_data_85 = vec_matlist(FC_list,q=0.85,binarize = TRUE)
FC_data_15 = vec_matlist(FC_list,q=0.15,binarize = TRUE)
FC_data = FC_data_85 + (1 - FC_data_15)*(-1)
library(nlss)
FC_data_85 = vec_matlist(FC_list,q=0.85,binarize = TRUE)
FC_data_15 = vec_matlist(FC_list,q=0.15,binarize = TRUE)
FC_data = FC_data_85 + (1 - FC_data_15)*(-1)
i = 1
res = readRDS(paste0("/Users/ben/Desktop/work2/Rpackagetest/nlss/S/res10000_9000_q8_fmri504_r",i,".rds"))
res = list()
for(i in 1:10){
res[[i]] = readRDS(paste0("/Users/ben/Desktop/work2/Rpackagetest/nlss/S/res10000_9000_q8_fmri504_r",i,".rds"))
}
res0 = readRDS(file = "/Users/ben/Desktop/work2/Rpackagetest/nlss/S/res10000_9000_q8_fmri504.rds")
Slist = list()
dim(res0$S)
Slist = list()
Slist[[1]] = res0$S
for(i in 1:10){
Slist[[i+1]] = res[[i]]$S
}
Slist2 = match_comp(Slist)
Slist2 = match_comp(Slist)
relia_comp(Slist2 )
data0 = res0$S
path0 = "/Users/ben/Desktop/work2/Rpackagetest/nlss/S/"
heatmap.net(data0 ,path = path0,community = group_2,color = bluered(3),legend="FC",filename = "S_fmri_8")
library(nlss)
heatmap.net(data0 ,path = path0,community = group_2,color = bluered(3),legend="FC",filename = "S_fmri_8")
############### PNC data  ###################
library(gplots)
heatmap.net(data0 ,path = path0,community = group_2,color = bluered(3),legend="FC",filename = "S_fmri_8")
library(ggplot2)
res7 = res0
A = NULL
ICs = NULL
for(i in 1:ncol(res7$A)){
A = c(A,res7$A[,i])
if(i < ncol(res7$A)){
ICs = c(ICs,rep(paste0("IC",i),nrow(res7$A)))
}
else{
ICs = c(ICs,rep("noise",nrow(res7$A)) )
}
}
A_PNC = data.frame(IC = as.factor(ICs ), A = A)
p = ggplot(A_PNC, aes(x=ICs, y=A ) ) +
geom_boxplot() + labs(x=NULL, y = NULL) + ylim(0,0.6)
p
#################PNC data######################
data_path = "/Users/ben/Desktop/work2/data/PNC data/Multimodal Data/"
load(paste0(data_path,"Pearson264.RData"))
load(paste0(data_path,"FMRI264.RData"))
load(paste0(data_path,"probtract.matrix.ave.RData"))
lengthlist = length(pearsonCorr.matrix)
group = read.table("/Users/ben/Desktop/work2/data/PNC/roi_id.txt")
group_1 = group$V1
group_2 = group_1[order(group_1)][-c(1:32)]
FC_list = list()
SC_list = list()
for(i in 1:lengthlist){
print(i)
tmp = pearsonCorr.matrix[[i]][order(group_1),order(group_1)]
FC_list[[i]] = tmp[-c(1:32),-c(1:32)]
tmp = probtract.matrix.ave[[i]][order(group_1),order(group_1)]
SC_list[[i]] = tmp[-c(1:32),-c(1:32)]
}
FC_data_85 = vec_matlist(FC_list,q=0.85,binarize = TRUE)
FC_data_15 = vec_matlist(FC_list,q=0.15,binarize = TRUE)
FC_data = FC_data_85 + (1 - FC_data_15)*(-1)
FC_list1 = list()
SC_list1 = list()
tag = 0
lengthlist
for(i in 1:lengthlist){
if(sum(is.na(SC_list[[i]]))==0){
tag = tag + 1
FC_list1[[tag]] = FC_list[[i]]
SC_list1[[tag]] = SC_list[[i]]
}
}
lengthlist1 = tag
lengthlist1
SC_data_85 = vec_matlist(SC_list1,q=0.85,binarize = TRUE)
res = readRDS(file = "/Users/ben/Desktop/work2/Rpackagetest/nlss/S/FCSCres10000_9000_q10.rds")
dim(res$S)
apply(res$A,2,mean)
res7 = res
A = NULL
ICs = NULL
for(i in 1:ncol(res7$A)){
A = c(A,res7$A[,i])
if(i < ncol(res7$A)){
ICs = c(ICs,rep(paste0("IC",i),nrow(res7$A)))
}
else{
ICs = c(ICs,rep("noise",nrow(res7$A)) )
}
}
A_PNC = data.frame(IC = as.factor(ICs ), A = A)
p = ggplot(A_PNC, aes(x=ICs, y=A ) ) +
geom_boxplot() + labs(x=NULL, y = NULL) + ylim(0,0.6)
p
##FCSC
FC_list1 = list()
SC_list1 = list()
tag = 0
for(i in 1:lengthlist){
if(sum(is.na(SC_list[[i]]))==0){
tag = tag + 1
FC_list1[[tag]] = FC_list[[i]]
SC_list1[[tag]] = SC_list[[i]]
}
}
lengthlist1 = tag
FC_data_85 = vec_matlist(FC_list1,q=0.85,binarize = TRUE)
FC_data_15 = vec_matlist(FC_list1,q=0.15,binarize = TRUE)
SC_data_85 = vec_matlist(SC_list1,q=0.85,binarize = TRUE)
FCSC_data_85 = FC_data_85*SC_data_85*5 + FC_data_85*(1-SC_data_85)*4 +
(FC_data_15 - FC_data_85)*SC_data_85*3 + SC_data_85*(1 - FC_data_15)*2 + (1 - FC_data_15)*(1-SC_data_85)
res10000_9000= NLSS(data=FCSC_data_85,q=4,total_iter = 10000, burn_in = 9000, show_step=10)
saveRDS(res10000_9000, file = "/Users/ben/Desktop/work2/Rpackagetest/nlss/S/FCSCres10000_9000_q4.rds")
res10000_9000= NLSS(data=FCSC_data_85,q=3,total_iter = 10000, burn_in = 9000, show_step=10)
saveRDS(res10000_9000, file = "/Users/ben/Desktop/work2/Rpackagetest/nlss/S/FCSCres10000_9000_q3.rds")
res = readRDS(file = "/Users/ben/Desktop/work2/Rpackagetest/nlss/S/FCSCres10000_9000_q10.rds")
heatmap.net(res$S==5,lim=c(0,1),path = path0,community = group_2,color = bluered(101)[-c(1:50)],legend="SC",filename = "FCSC5_10")
heatmap.net(res$S==5,lim=c(0,1),path = path0,community = group_2,color = bluered(3)[-1],legend="SC",filename = "FCSC5_10")
apply(res$A,2,mean)
heatmap.net(res$S==5,lim=c(0,1),path = path0,community = group_2,color = bluered(3)[-1],legend="SC",filename = "/FCSC/FCSC5_10")
heatmap.net(res$S==4,lim=c(0,1),path = path0,community = group_2,color = bluered(3)[-1],legend="SC",filename = "/FCSC/FCSC4_10")
heatmap.net(res$S==3,lim=c(0,1),path = path0,community = group_2,color = bluered(3)[-1],legend="SC",filename = "/FCSC/FCSC3_10")
heatmap.net(res$S==2,lim=c(0,1),path = path0,community = group_2,color = bluered(3)[-1],legend="SC",filename = "/FCSC/FCSC2_10")
heatmap.net(res$S==1,lim=c(0,1),path = path0,community = group_2,color = bluered(3)[-1],legend="SC",filename = "/FCSC/FCSC1_10")
A = NULL
ICs = NULL
for(i in 1:ncol(res$A)){
A = c(A,res$A[,i])
if(i < ncol(res$A)){
ICs = c(ICs,rep(paste0("IC",i),nrow(res7$A)))
}
else{
ICs = c(ICs,rep("noise",nrow(res7$A)) )
}
}
A_PNC = data.frame(IC = as.factor(ICs ), A = A)
p = ggplot(A_PNC, aes(x=ICs, y=A ) ) +
geom_boxplot() + labs(x=NULL, y = NULL) + ylim(0,0.6)
p
ggsave("/Users/ben/Desktop/work2/Rpackagetest/nlss/S/FCSC/A_FCSC_10.png",width = 19.8, height = 8, units = "cm")
res = readRDS(file = "/Users/ben/Desktop/work2/Rpackagetest/nlss/S/FCSCres10000_9000_q3.rds")
dim(res$S)
heatmap.net(res$S==1,lim=c(0,1),path = path0,community = group_2,color = bluered(3)[-1],legend="SC",filename = "/FCSC/FCSC1_3")
heatmap.net(res$S==2,lim=c(0,1),path = path0,community = group_2,color = bluered(3)[-1],legend="SC",filename = "/FCSC/FCSC2_3")
heatmap.net(res$S==3,lim=c(0,1),path = path0,community = group_2,color = bluered(3)[-1],legend="SC",filename = "/FCSC/FCSC3_3")
heatmap.net(res$S==4,lim=c(0,1),path = path0,community = group_2,color = bluered(3)[-1],legend="SC",filename = "/FCSC/FCSC4_3")
heatmap.net(res$S==5,lim=c(0,1),path = path0,community = group_2,color = bluered(3)[-1],legend="SC",filename = "/FCSC/FCSC5_3")
A = NULL
ICs = NULL
for(i in 1:ncol(res$A)){
A = c(A,res$A[,i])
if(i < ncol(res$A)){
ICs = c(ICs,rep(paste0("IC",i),nrow(res7$A)))
}
else{
ICs = c(ICs,rep("noise",nrow(res7$A)) )
}
}
A_PNC = data.frame(IC = as.factor(ICs ), A = A)
p = ggplot(A_PNC, aes(x=ICs, y=A ) ) +
geom_boxplot() + labs(x=NULL, y = NULL) + ylim(0,0.6)
p
A = NULL
ICs = NULL
for(i in 1:ncol(res$A)){
A = c(A,res$A[,i])
if(i < ncol(res$A)){
ICs = c(ICs,rep(paste0("IC",i),nrow(res$A)))
}
else{
ICs = c(ICs,rep("noise",nrow(res$A)) )
}
}
A_PNC = data.frame(IC = as.factor(ICs ), A = A)
p = ggplot(A_PNC, aes(x=ICs, y=A ) ) +
geom_boxplot() + labs(x=NULL, y = NULL) + ylim(0,0.6)
p
res$A
A = NULL
ICs = NULL
max(res$A)
A = NULL
ICs = NULL
for(i in 1:ncol(res$A)){
A = c(A,res$A[,i])
if(i < ncol(res$A)){
ICs = c(ICs,rep(paste0("IC",i),nrow(res$A)))
}
else{
ICs = c(ICs,rep("noise",nrow(res$A)) )
}
}
A_PNC = data.frame(IC = as.factor(ICs ), A = A)
p = ggplot(A_PNC, aes(x=ICs, y=A ) ) +
geom_boxplot() + labs(x=NULL, y = NULL) + ylim(0,0.7)
p
ggsave("/Users/ben/Desktop/work2/Rpackagetest/nlss/S/FCSC/A_FCSC_3.png",width = 19.8, height = 8, units = "cm")
res = readRDS(file = "/Users/ben/Desktop/work2/Rpackagetest/nlss/S/FCSCres10000_9000_q4.rds")
heatmap.net(res$S==5,lim=c(0,1),path = path0,community = group_2,color = bluered(3)[-1],legend="SC",filename = "/FCSC/FCSC5_4")
heatmap.net(res$S==4,lim=c(0,1),path = path0,community = group_2,color = bluered(3)[-1],legend="SC",filename = "/FCSC/FCSC4_4")
heatmap.net(res$S==3,lim=c(0,1),path = path0,community = group_2,color = bluered(3)[-1],legend="SC",filename = "/FCSC/FCSC3_4")
heatmap.net(res$S==2,lim=c(0,1),path = path0,community = group_2,color = bluered(3)[-1],legend="SC",filename = "/FCSC/FCSC2_4")
heatmap.net(res$S==1,lim=c(0,1),path = path0,community = group_2,color = bluered(3)[-1],legend="SC",filename = "/FCSC/FCSC1_4")
A = NULL
ICs = NULL
for(i in 1:ncol(res$A)){
A = c(A,res$A[,i])
if(i < ncol(res$A)){
ICs = c(ICs,rep(paste0("IC",i),nrow(res$A)))
}
else{
ICs = c(ICs,rep("noise",nrow(res$A)) )
}
}
A_PNC = data.frame(IC = as.factor(ICs ), A = A)
p = ggplot(A_PNC, aes(x=ICs, y=A ) ) +
geom_boxplot() + labs(x=NULL, y = NULL) + ylim(0,0.7)
p
ggsave("/Users/ben/Desktop/work2/Rpackagetest/nlss/S/FCSC/A_FCSC_4.png",width = 19.8, height = 8, units = "cm")
A_PNC = data.frame(IC = as.factor(ICs ), A = A)
p = ggplot(A_PNC, aes(x=ICs, y=A ) ) +
geom_boxplot() + labs(x=NULL, y = NULL) + ylim(0,0.6)
p
19.8/8
19.8/8*5
11/5*8
11/5*9
ggsave("/Users/ben/Desktop/work2/Rpackagetest/nlss/S/FCSC/sub/A_FCSC_4.png",width = 11, height = 8, units = "cm")
library(gplots)
library(nlss)
FMRI_path = "/Users/ben/Desktop/work2/data/PNC data/FMRI data/"
cova_path = "/Users/ben/Desktop/work2/data/PNC data/Demographic data/"
tmp1 = read.csv(paste0(cova_path,"PNC_Gender_Age.csv"))
tmp = read.csv(paste0(cova_path,"PNC_Phenotypes_imaging_subset1.csv"))
tmp = read.table(paste0(FMRI_path,"filtered.list.displac.25_2_.txt"))
sbj_ID_cova = tmp1$SUBJID
sbj_ID_fmri = tmp$V1
sbj_ID = intersect(sbj_ID_fmri,sbj_ID_cova)
match(sbj_ID,sbj_ID_fmri)
load(paste0(FMRI_path,"Pearson264.RData"))
group = read.table("/Users/ben/Desktop/work2/data/PNC/roi_id.txt")
group_1 = group$V1
group_2 = group_1[order(group_1)][-c(1:32)]
lengthlist = length(pearsonCorr.matrix)
res = list()
for(i in 1:10){
res[[i]] = readRDS(paste0("/Users/ben/Desktop/work2/Rpackagetest/nlss/S/res10000_9000_q8_fmri504_r",i,".rds"))
}
res0 = readRDS(file = "/Users/ben/Desktop/work2/Rpackagetest/nlss/S/res10000_9000_q8_fmri504.rds")
Slist = list()
Slist[[1]] = res0$S
for(i in 1:10){
Slist[[i+1]] = res[[i]]$S
}
Slist2 = match_comp(Slist)
library(nlss)
Slist2 = match_comp(Slist)
relia_comp(Slist2)
data_path = "/Users/ben/Desktop/work2/data/PNC data/Multimodal Data/"
load(paste0(data_path,"Pearson264.RData"))
load(paste0(data_path,"FMRI264.RData"))
load(paste0(data_path,"probtract.matrix.ave.RData"))
lengthlist = length(pearsonCorr.matrix)
group = read.table("/Users/ben/Desktop/work2/data/PNC/roi_id.txt")
group_1 = group$V1
group_2 = group_1[order(group_1)][-c(1:32)]
FC_list = list()
SC_list = list()
for(i in 1:lengthlist){
print(i)
tmp = pearsonCorr.matrix[[i]][order(group_1),order(group_1)]
FC_list[[i]] = tmp[-c(1:32),-c(1:32)]
tmp = probtract.matrix.ave[[i]][order(group_1),order(group_1)]
SC_list[[i]] = tmp[-c(1:32),-c(1:32)]
}
FC_data_85 = vec_matlist(FC_list,q=0.85,binarize = TRUE)
FC_data_15 = vec_matlist(FC_list,q=0.15,binarize = TRUE)
FC_data = FC_data_85 + (1 - FC_data_15)*(-1)
FC_list1 = list()
SC_list1 = list()
tag = 0
for(i in 1:lengthlist){
if(sum(is.na(SC_list[[i]]))==0){
tag = tag + 1
FC_list1[[tag]] = FC_list[[i]]
SC_list1[[tag]] = SC_list[[i]]
}
}
lengthlist1 = tag
SC_data_85 = vec_matlist(SC_list1,q=0.85,binarize = TRUE)
dim(FC_data)
path0
path0 = "/Users/ben/Desktop/work2/Rpackagetest/nlss/S/FCSC/sub/"
heatmap.net(FC_data[1,],lim=c(-1,1),path = path0,community = group_2,color = bluered(3),legend="FC",filename = "FCraw_single")
dim(FC_data_raw)
FC_data_raw = vec_matlist(FC_list)
SC_data_raw = vec_matlist(SC_list1)
heatmap.net(FC_data_raw[1,],lim=c(-1,1),path = path0,community = group_2,color = bluered(3),legend="FC",filename = "FCraw_single")
hist(FC_data[1,])
hist(FC_data_raw[1,])
heatmap.net(FC_data[1,],lim=c(-1,1),path = path0,community = group_2,color = bluered(3),legend="FC",filename = "FC_single")
heatmap.net(FC_data_raw[1,],lim=c(-1,1),path = path0,community = group_2,color = bluered(100),legend="FC",filename = "cor_single")
?bluered
bluered(1)
colorpanel(50,low="white",high = "#ffa501")
heatmap.net(SC_data_raw[1,],lim=c(0,1),path = path0,community = group_2,color = colorpanel(50,low="white",high = "#ffa501"),legend="SC",filename = "prob_single")
heatmap.net(SC_data[1,],lim=c(0,1),path = path0,community = group_2,color = c("#FFFFFF","#ffa501"),legend="SC",filename = "SC_single")
heatmap.net(SC_data_85[1,],lim=c(0,1),path = path0,community = group_2,color = c("#FFFFFF","#ffa501"),legend="SC",filename = "SC_single")
heatmap.net( ((SC_data_85[1,]!=0) + (FC_data[1,]!=0) ) !=0,lim=c(0,1),path = path0,community = group_2,color = c("#FFFFFF","#000000"),legend="SC",filename = "merge")
heatmap.net( ((SC_data_85[1,]==1)*(FC_data[1,]==1) ) !=0,lim=c(0,1),path = path0,community = group_2,color = c("#FFFFFF","#000000"),legend="SC",filename = "merge_FC1SC1")
path0 = "/Users/ben/Desktop/work2/Rpackagetest/nlss/S/FCSC/"
heatmap.net( ((SC_data_85[1,]==0)*(FC_data[1,]==1) ) !=0,lim=c(0,1),path = path0,community = group_2,color = c("#FFFFFF","#000000"),legend="SC",filename = "merge_FC1SC0")
heatmap.net( ((SC_data_85[1,]==1)*(FC_data[1,]==-1) ) !=0,lim=c(0,1),path = path0,community = group_2,color = c("#FFFFFF","#000000"),legend="SC",filename = "merge_FC-1SC1")
heatmap.net( ((SC_data_85[1,]==0)*(FC_data[1,]==-1) ) !=0,lim=c(0,1),path = path0,community = group_2,color = c("#FFFFFF","#000000"),legend="SC",filename = "merge_FC-1SC0")
heatmap.net( ((SC_data_85[1,]==1)*(FC_data[1,]==0) ) !=0,lim=c(0,1),path = path0,community = group_2,color = c("#FFFFFF","#000000"),legend="SC",filename = "merge_FC0SC1")
