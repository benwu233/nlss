hclustfun=function(c){hclust(c, method='mcquitty')},
lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(0.25, 4, 0.25 ) )
grab_grob()
})
grid.newpage()
library(gridExtra)
grid.arrange(grobs=gl, ncol=2, clip=TRUE)
dim(arr[[i]])
gl <- lapply(1:3, function(i){
heatmap.2(ad_S[[i]],Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NA,labCol=NA,dendrogram="none",RowSideColors = sidecolor, ColSideColors = sidecolor,
cexRow=1,cexCol=1,margins=c(0.1,0.1),col=color, breaks=seq(minS,maxS,h),
colsep = colsep0, rowsep = colsep0, sepcolor="black",
key = F, lhei = c(0.05,3.5), lwid = c(0.05,3.5))
grid.echo()
grid.grab()
})
colsep0
sidecolor = rep("#b7b7b7",length(community))
colsep0 = NULL
target = "#8c8c8c"
tmp = "#b7b7b7"
for(i in 2:length(community)){
if(community[i]!=community[i-1]){
sidecolor[i] = target
target = tmp
tmp = sidecolor[i]
colsep0 = c(colsep0,i-1)
}
else{
sidecolor[i] = sidecolor[i-1]
}
}
if(class(S)[1]!="matrix"){
S = t( as.matrix(S) )
}
colsep0
heatmap.2(ad_S[[i]],Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NA,labCol=NA,dendrogram="none",RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,margins=c(0.1,0.1),col=color, breaks=seq(minS,maxS,h),
colsep = colsep0, rowsep = colsep0, sepcolor="black",
key = FALSE, lhei = c(0.05,3.5), lwid = c(0.05,3.5))
i
i=1
heatmap.2(ad_S[[i]],Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NA,labCol=NA,dendrogram="none",RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,margins=c(0.1,0.1),col=color, breaks=seq(minS,maxS,h),
colsep = colsep0, rowsep = colsep0, sepcolor="black",
key = FALSE, lhei = c(0.05,3.5), lwid = c(0.05,3.5))
grid.echo()
heatmap.2(arr[[i]], dendrogram ='row',
Colv=FALSE, col=greenred(800),
key=FALSE, keysize=1.0, symkey=FALSE, density.info='none',
trace='none', colsep=1:10,
sepcolor='white', sepwidth=0.05,
scale="none",cexRow=0.2,cexCol=2,
labCol = colnames(arr[[i]]),
hclustfun=function(c){hclust(c, method='mcquitty')},
lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(0.25, 4, 0.25 ) )
grid.echo()
heatmap.2(ad_S[[i]],Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NA,labCol=NA,dendrogram="none",RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,margins=c(0.5,0.5),col=color, breaks=seq(minS,maxS,h),
colsep = colsep0, rowsep = colsep0, sepcolor="black",
key = FALSE, lhei = c(0.15,3.5), lwid = c(0.15,3.5))
grid.echo()
colsep0 = 1:50
heatmap.2(ad_S[[i]],Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NA,labCol=NA,dendrogram="none",RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,margins=c(0.1,0.1),col=color, breaks=seq(minS,maxS,h),
colsep = colsep0, rowsep = colsep0, sepcolor="black",
key = FALSE, lhei = c(0.05,3.5), lwid = c(0.05,3.5))
grid.echo()
heatmap.2(ad_S[[i]])
heatmap.2(ad_S[[i]])
heatmap.2(ad_S[[i]])
while (dev.cur()>1) dev.off()
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]])
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NA,labCol=NA,dendrogram="none",RowSideColors = sidecolor,
ColSideColors = sidecolor)
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NA,labCol=NA,dendrogram="none",RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,margins=c(0.1,0.1))
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NA,labCol=NA,dendrogram="none",RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,margins=c(0.1,0.1),col=color, breaks=seq(minS,maxS,h),
colsep = colsep0, rowsep = colsep0, sepcolor="black",
key = FALSE, lhei = c(0.05,3.5), lwid = c(0.05,3.5))
grid.echo()
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NA,labCol=NA,dendrogram="none",RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,margins=c(0.1,0.1),col=color, breaks=seq(minS,maxS,h),
colsep = colsep0, rowsep = colsep0, sepcolor="black")
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NA,labCol=NA,dendrogram="none",RowSideColors = sidecolor,
ColSideColors = sidecolor,
lhei = c(0.05,3.5), lwid = c(0.05,3.5))
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NA,labCol=NA,dendrogram="none",RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,margins=c(0.1,0.1), lhei = c(0.05,3.5), lwid = c(0.05,3.5))
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NA,labCol=NA,dendrogram="none",RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,margins=c(0.1,0.1), lhei = c(0.05,3.5), lwid = c(0.05,3.5))
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NA,labCol=NA,dendrogram="none",RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,margins=c(0.1,0.1),col=color, breaks=seq(minS,maxS,h),
colsep = colsep0, rowsep = colsep0, sepcolor="black",
key = FALSE, lhei = c(0.05,3.5), lwid = c(0.05,3.5))
grid.echo()
color
seq(minS,maxS,h)
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NA,labCol=NA,dendrogram="none",RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,margins=c(0.1,0.1),col=color,
colsep = colsep0, rowsep = colsep0, sepcolor="black",
key = FALSE, lhei = c(0.05,3.5), lwid = c(0.05,3.5))
grid.echo()
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NA,labCol=NA,dendrogram="none",RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,margins=c(0.1,0.1),col=color, breaks=seq(minS,maxS,h),
sepcolor="black",
key = FALSE, lhei = c(0.05,3.5), lwid = c(0.05,3.5))
grid.echo()
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NA,labCol=NA,dendrogram="none",RowSideColors = sidecolor,
ColSideColors = sidecolor,
key = FALSE, lhei = c(0.05,3.5), lwid = c(0.05,3.5))
grid.echo()
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]])
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],margins=c(0.1,0.1))
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],margins=c(0.1,0.1),lhei = c(0.05,3.5), lwid = c(0.05,3.5))
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],margins=c(0.1,0.1),lhei = c(0.05,3.5), lwid = c(0.05,3.5),
dendrogram="none")
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],margins=c(0.1,0.1),lhei = c(0.05,3.5), lwid = c(0.05,3.5),
dendrogram="none",
Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NA,labCol=NA,RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,col=color, breaks=seq(minS,maxS,h),
colsep = colsep0, rowsep = colsep0, sepcolor="black",
key = FALSE)
grid.echo()
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],margins=c(0.1,0.1),lhei = c(0.05,3.5), lwid = c(0.05,3.5),
dendrogram="none")
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]])
grid.echo()
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],margins=c(0.1,0.1),lhei = c(0.05,3.5), lwid = c(0.05,3.5),
dendrogram="none")
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],
Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NA,labCol=NA,RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,col=color, breaks=seq(minS,maxS,h),
colsep = colsep0, rowsep = colsep0, sepcolor="black",
key = FALSE)
grid.echo()
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],
cexRow=1,cexCol=1,col=color, breaks=seq(minS,maxS,h),
colsep = colsep0, rowsep = colsep0, sepcolor="black",
key = FALSE)
grid.echo()
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,col=color, breaks=seq(minS,maxS,h),
colsep = colsep0, rowsep = colsep0, sepcolor="black",
key = FALSE)
grid.echo()
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],
labRow=NA,labCol=NA,RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,col=color, breaks=seq(minS,maxS,h),
colsep = colsep0, rowsep = colsep0, sepcolor="black",
key = FALSE)
grid.echo()
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],margins=c(0.1,0.1),lhei = c(0.05,3.5), lwid = c(0.05,3.5),
dendrogram="none",
Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,col=color, breaks=seq(minS,maxS,h),
colsep = colsep0, rowsep = colsep0, sepcolor="black",
key = FALSE)
grid.echo()
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],margins=c(0.1,0.1),lhei = c(0.05,3.5), lwid = c(0.05,3.5),
dendrogram="none",
Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=FALSE,labCol=FALSE,RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,col=color, breaks=seq(minS,maxS,h),
colsep = colsep0, rowsep = colsep0, sepcolor="black",
key = FALSE)
grid.echo()
dim(ad_S[[i]])
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],margins=c(0.1,0.1),lhei = c(0.05,3.5), lwid = c(0.05,3.5),
dendrogram="none",
Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=rep(NA,50),labCol=rep(NA,50),RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,col=color, breaks=seq(minS,maxS,h),
colsep = colsep0, rowsep = colsep0, sepcolor="black",
key = FALSE)
grid.echo()
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],margins=c(0.1,0.1),lhei = c(0.05,3.5), lwid = c(0.05,3.5),
dendrogram="none",
Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,col=color, breaks=seq(minS,maxS,h),
colsep = colsep0, rowsep = colsep0, sepcolor="black",
key = FALSE)
grid.echo()
?heatmap.2
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],margins=c(0.1,0.1),lhei = c(0.05,3.5), lwid = c(0.05,3.5),
dendrogram="none",
Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NULL,labCol=NULL,RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,col=color, breaks=seq(minS,maxS,h),
colsep = colsep0, rowsep = colsep0, sepcolor="black",
key = FALSE)
grid.echo()
rownames(ad_S[[i]])
rownames(ad_S[[i]]) = rep("NA",50)
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],margins=c(0.1,0.1),lhei = c(0.05,3.5), lwid = c(0.05,3.5),
dendrogram="none",
Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NULL,labCol=NULL,RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,col=color, breaks=seq(minS,maxS,h),
colsep = colsep0, rowsep = colsep0, sepcolor="black",
key = FALSE)
grid.echo()
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],margins=c(0.1,0.1),lhei = c(0.05,3.5), lwid = c(0.05,3.5),
dendrogram="none",
Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NULL,labCol=NULL,RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,colRow="white",colCol="white",
col=color, breaks=seq(minS,maxS,h),
colsep = colsep0, rowsep = colsep0, sepcolor="black",
key = FALSE)
grid.echo()
colsep0 = NULL
while (dev.cur()>1) dev.off()
heatmap.2(ad_S[[i]],margins=c(0.1,0.1),lhei = c(0.05,3.5), lwid = c(0.05,3.5),
dendrogram="none",
Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NULL,labCol=NULL,RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,colRow="white",colCol="white",
col=color, breaks=seq(minS,maxS,h),
colsep = colsep0, rowsep = colsep0, sepcolor="black",
key = FALSE)
grid.echo()
gl <- lapply(1:3, function(i){
heatmap.2(ad_S[[i]],Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NA,labCol=NA,dendrogram="none",RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,colRow="white",colCol="white",
margins=c(0.1,0.1),col=color, breaks=seq(minS,maxS,h),
colsep = colsep0, rowsep = colsep0, sepcolor="black",
key = FALSE, lhei = c(0.05,3.5), lwid = c(0.05,3.5))
grid.echo()
grid.grab()
})
grid.newpage()
grid.arrange(grobs=gl, ncol=3, clip=TRUE)
grid.newpage()
grid.arrange(grobs=gl, ncol=2, clip=TRUE)
library(nlss)
library(nlss)
heatmap.net.new.nolg(res$S[,,300],lim = c(0,1), color = bluered(3)[-1])
heatmap.net(res$S[,,300],lim = c(0,1), color = bluered(3)[-1])
library(nlss)
heatmap.net(res$S[,,300],lim = c(0,1), color = bluered(3)[-1])
library(nlss)
set.seed(612)
#simulate data with NLSS
sim = sim_NLSS(n_node = 50, n = 50, alpha_0 = c(3,2,1.5), alpha_1 = 2)
res = NLSS(data=sim$X, states = c(0,1), state0 = 0,
q=3, q0=1,  total_iter = 5000, burn_in = 1000,
thin = 10, show_step=1000, joint=TRUE)
sum_res = NLSS_sum(res,th=0.95, nstart = 1, nend = 400)
heatmap.net(sum_res$S,lim = c(0,1), color = bluered(3)[-1])
dim(sum_res$S)
heatmap.net(sum_res$S,lim = c(0,1), color = bluered(3)[-1], ncol=3)
heatmap.net(sum_res$S,lim = c(0,1), color = c("white","black"), ncol=3)
#simulate data with NLSS
sim = sim_NLSS(n_node = 50, n = 50, alpha_0 = c(3,2,1.5), alpha_1 = 1)
res = NLSS(data=sim$X, states = c(0,1), state0 = 0,
q=3, q0=1,  total_iter = 5000, burn_in = 1000,
thin = 10, show_step=1000, joint=TRUE)
sum_res = NLSS_sum(res,th=0.95, nstart = 1, nend = 400)
heatmap.net(sum_res$S,lim = c(0,1), color = c("white","black"), ncol=3)
heatmap.net(sim$S,lim = c(0,1), color = c("white","black"), ncol=3)
library(nlss)
library(nlss)
library(nlss)
library(nlss)
library(nlss)
while (dev.cur()>1) dev.off()
gl = lapply(1:3, function(i){
heatmap.2(ad_S[[i]],Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NA,labCol=NA,dendrogram="none",RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,colRow="white",colCol="white",
margins=c(0.1,0.1),col=color, breaks=seq(minS,maxS,h),
colsep = colsep0, rowsep = colsep0, sepcolor="black",
key = FALSE, lhei = c(0.05,3.5), lwid = c(0.05,3.5))
grid.echo()
grid.grab()
})
grid.newpage()
grid.arrange(grobs=gl, ncol=ncol, clip=TRUE)
gl = lapply(1:3, function(i){
heatmap.2(ad_S[[i]],Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NA,labCol=NA,dendrogram="none",RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,colRow="white",colCol="white",
margins=c(0.1,0.1),col=color, breaks=seq(minS,maxS,h),
colsep = colsep0, rowsep = colsep0, sepcolor="black",
key = FALSE, lhei = c(0.05,3.5), lwid = c(0.05,3.5))
grid.echo()
grid.grab()
})
while (dev.cur()>1) dev.off()
grid.newpage()
grid.arrange(grobs=gl, ncol=ncol, clip=TRUE)
grid.arrange(grobs=gl, ncol=3, clip=TRUE)
gl = lapply(1:3, function(i){
heatmap.2(ad_S[[i]],Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NA,labCol=NA,dendrogram="none",RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,colRow="white",colCol="white",
margins=c(0.1,0.1),col=color, breaks=seq(minS,maxS,h),
colsep = colsep0, rowsep = colsep0, sepcolor="black",
key = FALSE, lhei = c(0.05,3.5), lwid = c(0.05,3.5))
grid.echo()
grid.grab()
})
while (dev.cur()>1) dev.off()
grid.newpage()
grid.arrange(grobs=gl, ncol=ncol, clip=TRUE)
gl = lapply(1:3, function(i){
heatmap.2(ad_S[[i]],Rowv = FALSE,Colv = FALSE,trace="none", symbreaks = TRUE,
labRow=NA,labCol=NA,dendrogram="none",RowSideColors = sidecolor,
ColSideColors = sidecolor,
cexRow=1,cexCol=1,colRow="white",colCol="white",
margins=c(0.1,0.1),col=color, breaks=seq(minS,maxS,h),
colsep = colsep0, rowsep = colsep0, sepcolor="black",
key = FALSE, lhei = c(0.05,3.5), lwid = c(0.05,3.5))
grid.echo()
grid.grab()
})
while (dev.cur()>1) dev.off()
grid.newpage()
grid.arrange(grobs=gl, ncol=3, clip=TRUE)
library(nlss)
dim(sum_res$S)
table(sum_res$S)
dim(sim$X)
table(sim$X)
table(sum_res$S_mode)
table(res$Sspace)
table(res$S)
rm(list=ls())
gc()
table(sum_res$S)
sum_res = NLSS_sum(res,th=0.95, nstart = 1, nend = 400)
#simulate data with NLSS
sim = sim_NLSS(n_node = 50, n = 50, alpha_0 = c(3,2,1.5), alpha_1 = 2)
heatmap.net(sim$S,lim = c(0,1), color = c("white","black"), ncol=3)
res = NLSS(data=sim$X, states = c(0,1), state0 = 0,
q=3, q0=1,  total_iter = 5000, burn_in = 1000,
thin = 10, show_step=1000, joint=TRUE)
table(sim$X)
table(res$S)
sum_res = NLSS_sum(res,th=0.95, nstart = 1, nend = 400)
table(sum_res$S)
res$states
res$K
res$state0
state0 = res$state0
states = res$states
n = dim(res$A)[1]
nend=400
nstart = 1
n_itrs = nend - nstart + 1
p = ncol(res$S)
q = nrow(res$S)
ncol(res$S)
nrow(res$S)
tmp = res$S[,,nstart:nend]
beta_coef = apply(tmp,c(1,2),count_rate,states,n_itrs)
count_rate = function(x,states,nitr){
return( table(factor(x,levels=states))/nitr )
}
S0 = states[apply(beta_coef,c(2,3),which.max)]
beta_coef = apply(tmp,c(1,2),count_rate,states,n_itrs)
beta_coef
table(beta_coef)
S0 = states[apply(beta_coef,c(2,3),which.max)]
dim(S0) = dim(res$S[,,1])
table(S)
table(S0)
S = S0
pip = 1 - beta_coef[which(states==state0),,]
if(th==1){
th=1-1e-6
}
th = 0.95
S = S0
pip = 1 - beta_coef[which(states==state0),,]
if(th==1){
th=1-1e-6
}
for(i in 1:q){
for(j in 1:p){
if(S[i,j]!=(state0) ){
if(beta_coef[S[i,j],i,j]<=th){
S[i,j] = state0
}
}
}
}
table(S)
heatmap.net(sum_res$S0,lim = c(0,1), color = c("white","black"), ncol=3)
sum_res = NLSS_sum(res,th=0.95, nstart = 1, nend = 400)
heatmap.net(sum_res$S0,lim = c(0,1), color = c("white","black"), ncol=3)
heatmap.net(sum_res$S0,lim = c(0,1), color = c("white","black"),
community = sim$community,ncol=3)
heatmap.net(sum_res$S_mode,lim = c(0,1), color = c("white","black"),
community = sim$community,ncol=3)
heatmap.net(sum_res$S,lim = c(0,1), color = c("white","black"),
community = sim$community,ncol=3)
sum_res = NLSS_sum(res,th=0.5, nstart = 1, nend = 400)
heatmap.net(sum_res$S,lim = c(0,1), color = c("white","black"),
community = sim$community,ncol=3)
table(sum_res$S)
table(S)
table(S0)
S = S0
q
p
state0
library(nlss)
sum_res = NLSS_sum(res,th=0.5, nstart = 1, nend = 400)
heatmap.net(sum_res$S,lim = c(0,1), color = c("white","black"),
community = sim$community,ncol=3)
heatmap.net(sim$S,lim = c(0,1), color = c("white","black"), ncol=3)
heatmap.net(sum_res$S,lim = c(0,1), color = c("white","black"),
community = sim$community,ncol=3)
heatmap.net(sum_res$S,lim = c(0,1), color = c("white","black"),
community = sim$community,ncol=3)
par(mai = c(0.6,0.6,0.3,0.1))
heatmap.net(sum_res$S,lim = c(0,1), color = c("white","black"),
community = sim$community,ncol=3)
library(nlss)
heatmap.net(sim$S,lim = c(0,1), color = c("white","black"), ncol=3)
```{r, message=FALSE, fig.keep='last', fig.dim = c(0.3,0.1)}
heatmap.net(sim$S,lim = c(0,1), color = c("white","black"), ncol=3)
heatmap.net(sim$S,lim = c(0,1), color = c("white","black"), ncol=3)
2/3
library(nlss)
library(nlss)
25000/160
25000/160+27
26030/160+7
