width = 5,height =5, units = "in",scale=0.5)
}
connt = c("fcn1","fc0","fc1")
c0 = 1
comp = 2
i = 5
j = 7
row_id = which(group_4$network_id==i)
col_id = which(group_4$network_id==j)
subset = find_subnet(S_listFC[[comp]],row_id,col_id,s0=c0,th=0.95)
ind = ((group_2==i) + (group_2==j) > 0)
M_zero = matrix(0, sum(group_2==i),sum(group_2==i))
M_zero1 = matrix(0, sum(group_2==j),sum(group_2==j))
tmp0 = rbind( cbind( M_zero,  subset), cbind( t(subset), M_zero1 ) )
#tmp0 = subset
ind0 = which( (group_2==i) + (group_2==j) > 0 )
nodecolor =  Mycolor[network2[ind0]]
brainconn(atlas = group_5[ind,], conmat = tmp0, node.size = 1.5,
node.color = nodecolor[which(apply(tmp0,2,sum)!=0)],
edge.width = 0.2, view="top")
for(view0 in c("top","front","left")){
p = brainconn(atlas = group_5[ind,], conmat = tmp0, node.size = 1.5,
node.color = nodecolor[which(apply(tmp0,2,sum)!=0)],
edge.width = 0.2, view=view0)
ggsave(paste0("/Users/ben/desktop/tmp/new_color/fc/dmn_sn_",connt[c0],"_",comp,"_",view0,".png"),p,
width = 5,height =5, units = "in",scale=0.5)
}
connt = c("fcn1","fc0","fc1")
c0 = 1
comp = 3
i = 8
j = 10
row_id = which(group_4$network_id==i)
col_id = which(group_4$network_id==j)
subset = find_subnet(S_listFC[[comp]],row_id,col_id,s0=c0,th=0.95)
ind = ((group_2==i) + (group_2==j) > 0)
M_zero = matrix(0, sum(group_2==i),sum(group_2==i))
M_zero1 = matrix(0, sum(group_2==j),sum(group_2==j))
tmp0 = rbind( cbind( M_zero,  subset), cbind( t(subset), M_zero1 ) )
#tmp0 = subset
ind0 = which( (group_2==i) + (group_2==j) > 0 )
nodecolor =  Mycolor[network2[ind0]]
brainconn(atlas = group_5[ind,], conmat = tmp0, node.size = 1.5,
node.color = nodecolor[which(apply(tmp0,2,sum)!=0)],
edge.width = 0.2, view="top")
for(view0 in c("top","front","left")){
p = brainconn(atlas = group_5[ind,], conmat = tmp0, node.size = 1.5,
node.color = nodecolor[which(apply(tmp0,2,sum)!=0)],
edge.width = 0.2, view=view0)
ggsave(paste0("/Users/ben/desktop/tmp/new_color/fc/sc_vis_",connt[c0],"_",comp,"_",view0,".png"),p,
width = 5,height =5, units = "in",scale=0.5)
}
connt = c("fcn1","fc0","fc1")
c0 = 1
comp = 3
i = 8
j = 12
row_id = which(group_4$network_id==i)
col_id = which(group_4$network_id==j)
subset = find_subnet(S_listFC[[comp]],row_id,col_id,s0=c0,th=0.95)
ind = ((group_2==i) + (group_2==j) > 0)
M_zero = matrix(0, sum(group_2==i),sum(group_2==i))
M_zero1 = matrix(0, sum(group_2==j),sum(group_2==j))
tmp0 = rbind( cbind( M_zero,  subset), cbind( t(subset), M_zero1 ) )
#tmp0 = subset
ind0 = which( (group_2==i) + (group_2==j) > 0 )
nodecolor =  Mycolor[network2[ind0]]
brainconn(atlas = group_5[ind,], conmat = tmp0, node.size = 1.5,
node.color = nodecolor[which(apply(tmp0,2,sum)!=0)],
edge.width = 0.2, view="top")
for(view0 in c("top","front","left")){
p = brainconn(atlas = group_5[ind,], conmat = tmp0, node.size = 1.5,
node.color = nodecolor[which(apply(tmp0,2,sum)!=0)],
edge.width = 0.2, view=view0)
ggsave(paste0("/Users/ben/desktop/tmp/new_color/fc/sc_hssm_",connt[c0],"_",comp,"_",view0,".png"),p,
width = 5,height =5, units = "in",scale=0.5)
}
connt = c("fcn1","fc0","fc1")
c0 = 1
comp = 3
i = 8
j = 9
row_id = which(group_4$network_id==i)
col_id = which(group_4$network_id==j)
subset = find_subnet(S_listFC[[comp]],row_id,col_id,s0=c0,th=0.95)
ind = ((group_2==i) + (group_2==j) > 0)
M_zero = matrix(0, sum(group_2==i),sum(group_2==i))
M_zero1 = matrix(0, sum(group_2==j),sum(group_2==j))
tmp0 = rbind( cbind( M_zero,  subset), cbind( t(subset), M_zero1 ) )
#tmp0 = subset
ind0 = which( (group_2==i) + (group_2==j) > 0 )
nodecolor =  Mycolor[network2[ind0]]
brainconn(atlas = group_5[ind,], conmat = tmp0, node.size = 1.5,
node.color = nodecolor[which(apply(tmp0,2,sum)!=0)],
edge.width = 0.2, view="top")
connt = c("fcn1","fc0","fc1")
c0 = 1
comp = 3
i = 8
j = 9
row_id = which(group_4$network_id==i)
col_id = which(group_4$network_id==j)
subset = find_subnet(S_listFC[[comp]],row_id,col_id,s0=c0,th=0.95)
ind = ((group_2==i) + (group_2==j) > 0)
M_zero = matrix(0, sum(group_2==i),sum(group_2==i))
M_zero1 = matrix(0, sum(group_2==j),sum(group_2==j))
tmp0 = rbind( cbind( M_zero,  subset), cbind( t(subset), M_zero1 ) )
#tmp0 = subset
ind0 = which( (group_2==i) + (group_2==j) > 0 )
nodecolor =  Mycolor[network2[ind0]]
brainconn(atlas = group_5[ind,], conmat = tmp0, node.size = 1.5,
node.color = nodecolor[which(apply(tmp0,2,sum)!=0)],
edge.width = 0.2, view="top")
connt = c("fcn1","fc0","fc1")
c0 = 1
comp = 1
i = 8
j = 9
row_id = which(group_4$network_id==i)
col_id = which(group_4$network_id==j)
subset = find_subnet(S_listFC[[comp]],row_id,col_id,s0=c0,th=0.95)
ind = ((group_2==i) + (group_2==j) > 0)
M_zero = matrix(0, sum(group_2==i),sum(group_2==i))
M_zero1 = matrix(0, sum(group_2==j),sum(group_2==j))
tmp0 = rbind( cbind( M_zero,  subset), cbind( t(subset), M_zero1 ) )
#tmp0 = subset
ind0 = which( (group_2==i) + (group_2==j) > 0 )
nodecolor =  Mycolor[network2[ind0]]
brainconn(atlas = group_5[ind,], conmat = tmp0, node.size = 1.5,
node.color = nodecolor[which(apply(tmp0,2,sum)!=0)],
edge.width = 0.2, view="top")
connt = c("fcn1","fc0","fc1")
c0 = 3
comp = 3
i = 8
j = 9
row_id = which(group_4$network_id==i)
col_id = which(group_4$network_id==j)
subset = find_subnet(S_listFC[[comp]],row_id,col_id,s0=c0,th=0.95)
ind = ((group_2==i) + (group_2==j) > 0)
M_zero = matrix(0, sum(group_2==i),sum(group_2==i))
M_zero1 = matrix(0, sum(group_2==j),sum(group_2==j))
tmp0 = rbind( cbind( M_zero,  subset), cbind( t(subset), M_zero1 ) )
#tmp0 = subset
ind0 = which( (group_2==i) + (group_2==j) > 0 )
nodecolor =  Mycolor[network2[ind0]]
brainconn(atlas = group_5[ind,], conmat = tmp0, node.size = 1.5,
node.color = nodecolor[which(apply(tmp0,2,sum)!=0)],
edge.width = 0.2, view="top")
for(view0 in c("top","front","left")){
p = brainconn(atlas = group_5[ind,], conmat = tmp0, node.size = 1.5,
node.color = nodecolor[which(apply(tmp0,2,sum)!=0)],
edge.width = 0.2, view=view0)
ggsave(paste0("/Users/ben/desktop/tmp/new_color/fc/sc_cb_",connt[c0],"_",comp,"_",view0,".png"),p,
width = 5,height =5, units = "in",scale=0.5)
}
library(torch)
library(torchvision)
load("/Users/ben/Desktop/work3/BNNSTGP/index.RData")
load("/Users/ben/Desktop/work3/BNNSTGP/mnist_idx.RData")
mnist = readRDS("/Users/ben/Desktop/work3/BNNSTGP/mnist.rds")
f_mnist = readRDS(file = "/Users/ben/Desktop/work3/BNNSTGP/f_mnist.rds")
source("/Users/ben/Desktop/work3/BNNSTGP/script/func.R")
############### PNC data  ###################
library(gplots)
library(nlss)
library(gtools)
library(abind)
library(DescTools)
library(Rcpp)
#################
.Machine$double.xmin
S_match = readRDS("/Users/ben/desktop/data_nlss/bs/S_match_bsFC.rds")
relia00 = relia_rows(S_match,conn_only=FALSE)
relia00
28*24*7
S_match = readRDS("/Users/ben/desktop/data_nlss/bs/S_match_bsFC.rds")
class(S_match )
dim(S_match[[1]])
length(S_match)
relia00 = relia_rows(S_match,conn_only=FALSE)
relia00
S_match = readRDS("/Users/ben/desktop/data_nlss/bs/S_match_bsFCSC.rds")
relia00 = relia_rows(S_match,conn_only=FALSE)
relia00
S_match = readRDS("/Users/ben/desktop/data_nlss/bs/S_match_bsFC.rds")
path0 = "/Users/ben/desktop/"
heatmap.net.new.nolg(S_match[[1]]-2,lim=c(-1,1),path = path0,community = group_2,color = bluered(3), filename = paste0("test") )
S_match = readRDS("/Users/ben/desktop/data_nlss/bs/S_match_bsFCSC.rds")
heatmap.net.new.nolg( S_match[[1]]-1,lim=c(0,5),path = path0,community = group_2,color = c("#FFFFFF","#0247FE","#66B032","#c336ff","#FB9902","#FE2712"),
filename = paste0("test_fcsc") )
50*180
80*120
############### PNC data  ###################
library(gplots)
library(nlss)
library(gtools)
library(abind)
library(DescTools)
library(Rcpp)
#################
group0 = read.csv("/Users/ben/desktop/data_nlss/roi_id_power.csv")
group = group0
order0 = c(12,11,3,8,9,6,5,10,13,7,4,1,2)
for(i in 1:13){
group$network_id[group$network_id==order0[i]] = i+ 100
}
group$network_id[group$network_id!=-1] = group$network_id[group$network_id!=-1] - 100
group_1 = group$network_id
group_2 = group_1[order(group_1)][-c(1:28)]
FC_data_raw = readRDS("/Users/ben/desktop/data_nlss/FC_data_raw_247_ordered.rds")
z_score_FC = FisherZ(FC_data_raw)
p = pnorm(abs(z_score_FC),sd=1/sqrt(117),lower.tail = FALSE)*2
adjp = apply(p,1,p.adjust,method = "bonferroni")
FC = (t(adjp)<0.05) * sign(z_score_FC)
SC = readRDS("/Users/ben/desktop/data_nlss/SC_data_85_247_ordered.rds")
FCSC = (FC==1)*SC*5 + (FC==1)*(1-SC)*4 + (FC==-1)*SC*3 + (FC==-1)*(1-SC)*2 + (FC==0)*SC
dim(FC)
table(FC[1,])
resFC = NLSS(data=FC, q=10, k0=0,
total_iter = 5000, burn_in = 0, thin = 10, show_step=1000, joint=TRUE,
sprs = 1)
saveRDS(resFC, "/Users/ben/desktop/data_nlss/resFC2sprs1_allnew_q10.rds")
dim(resFC$S)
table(resFC$S[1,,10])
res_sumFC = NLSS_sum(resFC,th=0.95, k0 = 1, 101,500)
res_sumFC = NLSS_sum(resFC,th=0.95, k0 = 1, nstart = 101, nend = 500)
saveRDS(res_sumFC, "/Users/ben/desktop/data_nlss/res_sumFC2_sprs1_allnew_q10.rds")
resFC = NLSS(data=FC, q=6, k0=0,
total_iter = 5000, burn_in = 0, thin = 10, show_step=1000, joint=TRUE,
sprs = 1)
saveRDS(resFC, "/Users/ben/desktop/data_nlss/resFC2sprs1_allnew_q6.rds")
res_sumFC = NLSS_sum(resFC,th=0.95, k0 = 1, nstart = 101, nend = 500)
saveRDS(res_sumFC, "/Users/ben/desktop/data_nlss/res_sumFC2_sprs1_allnew_q6.rds")
resFCSC = NLSS(data=FCSC, q=6, k0=1,
total_iter = 5000, burn_in = 0, thin = 10, show_step=1000, joint=TRUE,
sprs = 2)
saveRDS(resFCSC, "/Users/ben/desktop/data_nlss/resFCSC2sprs2_allnew_q6.rds")
dim(FCSC)
table(FCSC[1,])
resFCSC = NLSS(data=FCSC, q=6, k0=0,
total_iter = 5000, burn_in = 0, thin = 10, show_step=1000, joint=TRUE,
sprs = 2)
saveRDS(resFCSC, "/Users/ben/desktop/data_nlss/resFCSC2sprs2_allnew_q6.rds")
dim(resFCSC)
dim(resFCSC$S)
table(resFCSC$S[1,,100])
res_sumFCSC = NLSS_sum(resFCSC,th=0.95, k0 = 1, nstart = 101, nend = 500)
saveRDS(res_sumFCSC, "/Users/ben/desktop/data_nlss/res_sumFC2_sprs1_allnew_q6.rds")
dim(res_sumFCSC$S)
table(res_sumFCSC$S[1,])
heatmap.net.new.nolg( res_sumFCSC$S-1,lim=c(0,5),path = path0,community = group_2,color = c("#FFFFFF","#0247FE","#66B032","#c336ff","#FB9902","#FE2712"),
filename = paste0("test_fcsc") )
heatmap.net.new.nolg( res_sumFCSC$S-1,lim=c(0,5),path = path0,community = group_2,color = c("#FFFFFF","#0247FE","#66B032","#c336ff","#FB9902","#FE2712"),
filename = paste0("test_fcsc") )
S_match = readRDS("/Users/ben/desktop/data_nlss/bs/S_match_bsFCSC.rds")
heatmap.net.new.nolg( S_match[[1]]-1,lim=c(0,5),path = path0,community = group_2,color = c("#FFFFFF","#0247FE","#66B032","#c336ff","#FB9902","#FE2712"),
filename = paste0("test_fcsc") )
resFC = readRDS("/Users/ben/desktop/data_nlss/resFC2sprs1_allnew_q6.rds")
dim(resFC$S)
table(resFC$S[1,,10])
res_sumFC = NLSS_sum(resFC,th=0.95, k0 = 2, nstart = 101, nend = 500)
heatmap.net.new.nolg(res_sumFC$S-2,lim=c(-1,1),path = path0,community = group_2,color = bluered(3), filename = paste0("test") )
for(q0 in c(5,6,7,9,10,11,12)){
print(q0)
resFC = NLSS(data=FC, q=q0, k0=0,
total_iter = 5000, burn_in = 0, thin = 10, show_step=5000, joint=TRUE,
sprs = 1)
saveRDS(resFC, paste0("/Users/ben/desktop/data_nlss/resFC2sprs1_allnew_q",q0,".rds"))
res_sumFC = NLSS_sum(resFC,th=0.95, k0 = 2, nstart = 101, nend = 500)
saveRDS(res_sumFC, paste0("/Users/ben/desktop/data_nlss/res_sumFC2_sprs1_allnew_q",q0,".rds"))
resFCSC = NLSS(data=FCSC, q=q0, k0=0,
total_iter = 5000, burn_in = 0, thin = 10, show_step=5000, joint=TRUE,
sprs = 2)
saveRDS(resFCSC, paste0("/Users/ben/desktop/data_nlss/resFCSC2sprs2_allnew_q",q0,".rds") )
res_sumFCSC = NLSS_sum(resFCSC,th=0.95, k0 = 1, nstart = 101, nend = 500)
saveRDS(res_sumFCSC, paste0("/Users/ben/desktop/data_nlss/res_sumFCSC2_sprs2_allnew_q",q0,".rds") )
}
q0
rm(resFC)
rm(res_sumFC)
rm(S_listFC)
rm(S_listFCSC)
rm(list=ls())
gc()
############### PNC data  ###################
library(gplots)
library(nlss)
library(gtools)
library(abind)
library(DescTools)
library(Rcpp)
#################
group0 = read.csv("/Users/ben/desktop/data_nlss/roi_id_power.csv")
group = group0
order0 = c(12,11,3,8,9,6,5,10,13,7,4,1,2)
for(i in 1:13){
group$network_id[group$network_id==order0[i]] = i+ 100
}
group$network_id[group$network_id!=-1] = group$network_id[group$network_id!=-1] - 100
group_1 = group$network_id
group_2 = group_1[order(group_1)][-c(1:28)]
FC_data_raw = readRDS("/Users/ben/desktop/data_nlss/FC_data_raw_247_ordered.rds")
z_score_FC = FisherZ(FC_data_raw)
p = pnorm(abs(z_score_FC),sd=1/sqrt(117),lower.tail = FALSE)*2
adjp = apply(p,1,p.adjust,method = "bonferroni")
FC = (t(adjp)<0.05) * sign(z_score_FC)
SC = readRDS("/Users/ben/desktop/data_nlss/SC_data_85_247_ordered.rds")
FCSC = (FC==1)*SC*5 + (FC==1)*(1-SC)*4 + (FC==-1)*SC*3 + (FC==-1)*(1-SC)*2 + (FC==0)*SC
q0=10
resFCSC = NLSS(data=FCSC, q=q0, k0=0,
total_iter = 5000, burn_in = 0, thin = 10, show_step=500, joint=TRUE,
sprs = 2)
saveRDS(resFCSC, paste0("/Users/ben/desktop/data_nlss/resFCSC2sprs2_allnew_q",q0,".rds") )
res_sumFCSC = NLSS_sum(resFCSC,th=0.95, k0 = 1, nstart = 101, nend = 500)
saveRDS(res_sumFCSC, paste0("/Users/ben/desktop/data_nlss/res_sumFCSC2_sprs2_allnew_q",q0,".rds") )
q0=11
rm(list=ls())
gc()
############### PNC data  ###################
library(gplots)
library(nlss)
library(gtools)
library(abind)
library(DescTools)
library(Rcpp)
#################
group0 = read.csv("/Users/ben/desktop/data_nlss/roi_id_power.csv")
group = group0
order0 = c(12,11,3,8,9,6,5,10,13,7,4,1,2)
for(i in 1:13){
group$network_id[group$network_id==order0[i]] = i+ 100
}
group$network_id[group$network_id!=-1] = group$network_id[group$network_id!=-1] - 100
group_1 = group$network_id
group_2 = group_1[order(group_1)][-c(1:28)]
FC_data_raw = readRDS("/Users/ben/desktop/data_nlss/FC_data_raw_247_ordered.rds")
z_score_FC = FisherZ(FC_data_raw)
p = pnorm(abs(z_score_FC),sd=1/sqrt(117),lower.tail = FALSE)*2
adjp = apply(p,1,p.adjust,method = "bonferroni")
FC = (t(adjp)<0.05) * sign(z_score_FC)
SC = readRDS("/Users/ben/desktop/data_nlss/SC_data_85_247_ordered.rds")
FCSC = (FC==1)*SC*5 + (FC==1)*(1-SC)*4 + (FC==-1)*SC*3 + (FC==-1)*(1-SC)*2 + (FC==0)*SC
q0=11
print(q0)
resFC = NLSS(data=FC, q=q0, k0=0,
total_iter = 5000, burn_in = 0, thin = 10, show_step=5000, joint=TRUE,
sprs = 1)
saveRDS(resFC, paste0("/Users/ben/desktop/data_nlss/resFC2sprs1_allnew_q",q0,".rds"))
res_sumFC = NLSS_sum(resFC,th=0.95, k0 = 2, nstart = 101, nend = 500)
saveRDS(res_sumFC, paste0("/Users/ben/desktop/data_nlss/res_sumFC2_sprs1_allnew_q",q0,".rds"))
resFCSC = NLSS(data=FCSC, q=q0, k0=0,
total_iter = 5000, burn_in = 0, thin = 10, show_step=500, joint=TRUE,
sprs = 2)
rm(list=ls())
gc()
############### PNC data  ###################
library(gplots)
library(nlss)
library(gtools)
library(abind)
library(DescTools)
library(Rcpp)
#################
group0 = read.csv("/Users/ben/desktop/data_nlss/roi_id_power.csv")
group = group0
order0 = c(12,11,3,8,9,6,5,10,13,7,4,1,2)
for(i in 1:13){
group$network_id[group$network_id==order0[i]] = i+ 100
}
group$network_id[group$network_id!=-1] = group$network_id[group$network_id!=-1] - 100
group_1 = group$network_id
group_2 = group_1[order(group_1)][-c(1:28)]
FC_data_raw = readRDS("/Users/ben/desktop/data_nlss/FC_data_raw_247_ordered.rds")
z_score_FC = FisherZ(FC_data_raw)
p = pnorm(abs(z_score_FC),sd=1/sqrt(117),lower.tail = FALSE)*2
adjp = apply(p,1,p.adjust,method = "bonferroni")
FC = (t(adjp)<0.05) * sign(z_score_FC)
SC = readRDS("/Users/ben/desktop/data_nlss/SC_data_85_247_ordered.rds")
FCSC = (FC==1)*SC*5 + (FC==1)*(1-SC)*4 + (FC==-1)*SC*3 + (FC==-1)*(1-SC)*2 + (FC==0)*SC
q0=11
resFCSC = NLSS(data=FCSC, q=q0, k0=0,
total_iter = 5000, burn_in = 0, thin = 10, show_step=500, joint=TRUE,
sprs = 2)
resFCSC = NLSS(data=FCSC, q=q0, k0=0,
total_iter = 5000, burn_in = 0, thin = 10, show_step=500, joint=TRUE,
sprs = 1)
240*160
320*160
19119/160
19119/160 +16
240-30
q0 = 5
res_sumFC = readRDS("/Users/ben/desktop/data_nlss/res_sumFC2_sprs1_allnew.rds")
res_sumFCSC = readRDS("/Users/ben/desktop/data_nlss/res_sumFCSC2_sprs2_allnew.rds")
135 + 200
160*2+80
q0 = 5
res_sumFC_q = readRDS(paste0("/Users/ben/desktop/data_nlss/res_sumFC2_sprs1_allnew_q",q0,".rds"))
?match_rows
compute.match.idx.s.tra2
compute.match.idx.s.tra2 = function(S_est,S_true){
dist_mat = compute.comp.match.mat2(S_true,S_est)
per = permutations(ncol(dist_mat),nrow(dist_mat))
sum.match = function(x){
out = 0
for(i in 1:length(x)){
out = out + dist_mat[i,x[i]]
}
return(out)
}
return( per[which.max(apply(per,1,sum.match)),] )
}
compute.comp.match.mat2 = function(S_true,S_est){
idx = expand.grid(1:nrow(S_true),1:nrow(S_est))
return(matrix(sapply_pb(1:nrow(idx),
function(i) mean(S_true[idx[i,1],]==S_est[idx[i,2],])),
nrow=nrow(S_true),ncol=nrow(S_est)))
}
dim(res_sumFC$S)
compute.match.idx.s.tra2(res_sumFC_q$S,res_sumFC$S[1:3,])
sapply_pb <- function(X, FUN, ...)
{
env <- environment()
pb_Total <- length(X)
counter <- 0
pb <- txtProgressBar(min = 0, max = pb_Total, style = 3)
wrapper <- function(...){
curVal <- get("counter", envir = env)
assign("counter", curVal +1 ,envir=env)
setTxtProgressBar(get("pb", envir=env), curVal +1)
FUN(...)
}
res <- sapply(X, wrapper, ...)
close(pb)
res
}
compute.match.idx.s.tra2(res_sumFC_q$S,res_sumFC$S[1:3,])
S1 = res_sumFC_q$S[compute.match.idx.s.tra2(res_sumFC_q$S,res_sumFC$S[1:3,]),]
S0 = res_sumFC$S[1:3,]
S1 = res_sumFC_q$S[compute.match.idx.s.tra2(res_sumFC_q$S,S0),]
dim(S1)
for(i in 1:3){
print( sum(S1[i,]==S0[i,])/27730 )
}
dice_FC = matrix(0,nrow = 3, ncol= 5)
S0 = res_sumFC$S[1:3,]
tag = 1
for(q0 in c(5,6,7,9,10)){
res_sumFC_q = readRDS(paste0("/Users/ben/desktop/data_nlss/res_sumFC2_sprs1_allnew_q",q0,".rds"))
S1 = res_sumFC_q$S[compute.match.idx.s.tra2(res_sumFC_q$S,S0),]
for(i in 1:3){
dice_FC[i,tag] =  sum(S1[i,]==S0[i,])/27730
}
tag = tag + 1
}
dice_FC
dim(res_sumFC$A)
apply(res_sumFC$A,2,mean)
tmp = apply( res_sumFC$A,2,mean)[-9]
A = res_sumFC$A[,-9]
A1 = A[,order(tmp,decreasing = TRUE)]
SFC =  res_sumFC$S[order(tmp,decreasing = TRUE),]
#heatmap.net.new.nolg(SFC-2,lim=c(-1,1),path = path0,community = group_2,color = bluered(3), filename = paste0("FC") )
tmp = apply( res_sumFCSC$A,2,mean)[-9]
SFCSC =  res_sumFCSC$S[order(tmp,decreasing = TRUE),]
heatmap.net.new.nolg(SFC-2,lim=c(-1,1),path = path0,community = group_2,color = bluered(3), filename = paste0("FC") )
path0 = "/Users/ben/desktop/"
heatmap.net.new.nolg(SFC-2,lim=c(-1,1),path = path0,community = group_2,color = bluered(3), filename = paste0("FC") )
tmp = apply( res_sumFCSC$A,2,mean)[-9]
SFCSC =  res_sumFCSC$S[order(tmp,decreasing = TRUE),]
heatmap.net.new.nolg(SFCSC-1,lim=c(0,5),path = path0,community = group_2,color = c("#FFFFFF","#0247FE","#66B032","#c336ff","#FB9902","#FE2712"),
filename = paste0("test_fcsc") )
dim(SFC)
dice_FC = matrix(0,nrow = 3, ncol= 5)
dice_FCSC = matrix(0,nrow = 3, ncol= 5)
S0 = SFC[1:3,]
S00 = SFCSC[c(1,2,4),]
tag = 1
for(q0 in c(5,6,7,9,10)){
res_sumFC_q = readRDS(paste0("/Users/ben/desktop/data_nlss/res_sumFC2_sprs1_allnew_q",q0,".rds"))
S1 = res_sumFC_q$S[compute.match.idx.s.tra2(res_sumFC_q$S,S0),]
for(i in 1:3){
dice_FC[i,tag] =  sum(S1[i,]==S0[i,])/27730
}
tag = tag + 1
}
dice_FC
dice_FC = matrix(0,nrow = 3, ncol= 5)
dice_FCSC = matrix(0,nrow = 3, ncol= 5)
S0 = SFC[1:3,]
S00 = SFCSC[c(1,2,4),]
tag = 1
for(q0 in c(5,6,7,9,10)){
res_sumFC_q = readRDS(paste0("/Users/ben/desktop/data_nlss/res_sumFC2_sprs1_allnew_q",q0,".rds"))
res_sumFCSC_q = readRDS(paste0("/Users/ben/desktop/data_nlss/res_sumFCSC2_sprs2_allnew_q",q0,".rds"))
S1 = res_sumFC_q$S[compute.match.idx.s.tra2(res_sumFC_q$S,S0),]
S11 = res_sumFCSC_q$S[compute.match.idx.s.tra2(res_sumFCSC_q$S,S00),]
for(i in 1:3){
dice_FC[i,tag] =  sum(S1[i,]==S0[i,])/27730
dice_FCSC[i,tag] = sum(S11[i,]==S00[i,])/27730
}
tag = tag + 1
}
dice_FC
dice_FCSC
sim = sim_NLSS2(n_node = 50, n = 50, alpha_0 = c(3,2,1.5), alpha_1 = 2)
table(sim$X)
res = NLSS(data=sim$X, q=3, k0=0, total_iter = 5000, burn_in = 1000, thin = 10, show_step=5000, joint=TRUE, sprs = 1)
dim(res$S)
table(res$S[,,1])
sum_res = NLSS_sum(res,th=0.95, k0 = 1, nstart = 1, nend = 400)
